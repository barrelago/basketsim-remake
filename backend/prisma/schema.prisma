generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int     @id @default(autoincrement())
  email     String  @unique
  name      String
  password  String
  role      String  @default("player")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  team      Team?
  @@map("users")
}

model Team {
  id        Int     @id @default(autoincrement())
  name      String  @unique
  country   String
  userId    Int?    @unique
  user      User?   @relation(fields: [userId], references: [id], onDelete: Cascade)
  budget    Float   @default(1000000)
  wins      Int     @default(0)
  losses    Int     @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  roster    TeamRoster[]
  @@map("teams")
}

model Player {
  id        Int     @id @default(autoincrement())
  firstName String
  lastName  String
  age       Int
  position  String  // PG, SG, SF, PF, C
  height    String  // e.g., "6'7"
  weight    Int     // in lbs
  
  // Skills (0-100)
  speed     Int
  strength  Int
  shooting  Int
  defense   Int
  stamina   Int
  
  salary    Float   // Annual salary
  overall   Int     // Overall rating 0-100
  status    String  @default("available") // available, drafted, injured
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  rosters   TeamRoster[]
  @@map("players")
}

model TeamRoster {
  id        Int     @id @default(autoincrement())
  teamId    Int
  team      Team    @relation(fields: [teamId], references: [id], onDelete: Cascade)
  playerId  Int
  player    Player  @relation(fields: [playerId], references: [id], onDelete: Cascade)
  
  position  String  // Starting position on team
  number    Int     // Jersey number
  draftedAt DateTime @default(now())
  
  @@unique([teamId, playerId])
  @@map("team_rosters")
}

model Match {
  id        Int     @id @default(autoincrement())
  homeTeamId Int
  awayTeamId Int
  homeScore Int     @default(0)
  awayScore Int     @default(0)
  status    String  @default("scheduled")
  type      String  @default("league") // "league" or "friendly"
  playedAt  DateTime?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("matches")
}
